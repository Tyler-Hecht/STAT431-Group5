d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(16, 1/125)
tau.btw ~ dgamma(16, 1/125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
?dgamma
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(16, 125)
tau.btw ~ dgamma(16, 125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(1/16, 1/125)
tau.btw ~ dgamma(1/16, 1/125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(1/16, 125)
tau.btw ~ dgamma(1/16, 125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
12/13
sqrt(25*0.2*0.8)
pnorm(2)
model.1a = "model {
for( i in 1:N) {
xcent[i] <- x[i] - mean(x[])
}
for (i in 1:N) {
mu[i] <- beta0 + beta1 * xcent[i]
y[i] ˜ dnorm( mu[i], tausq )
}
beta0 ˜ dflat()
beta1 ˜ dflat()
tausq ˜ dgamma( 0.001, 0.001)
sigma <- 1 / sqrt(tausq) # regression standard
deviation
}
"
data.1a = list( x = c(1997, 1998, 1999, 2000, 2001, 2002, 2003,
2004, 2005, 2006, 2007, 2008, 2009, 2010),
y = c(2.2952, 2.3435, 2.5512, 2.5531, 2.3918,
2.1546, 2.3596,
2.2431, 2.1725, 2.3162, 2.3504, 2.1926,
1.9638, 2.2025),
N = 14)
inits = list( beta0 = 0, beta1 = 0, tausq = 1)
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
cat(model.1a, file = {Ex18.1model = tempfile()})
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
library(rjags)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
model.1a = "model {
for( i in 1:N) {
xcent[i] <- x[i] - mean(x[])
}
for (i in 1:N) {
mu[i] <- beta0 + beta1 * xcent[i]
y[i] ~ dnorm( mu[i], tausq )
}
beta0 ~ dflat()
beta1 ~ dflat()
tausq ~ dgamma( 0.001, 0.001)
sigma <- 1 / sqrt(tausq)
}
"
cat(model.1a, file = {Ex18.1model = tempfile()})
data.1a = list( x = c(1997, 1998, 1999, 2000, 2001, 2002, 2003,
2004, 2005, 2006, 2007, 2008, 2009, 2010),
y = c(2.2952, 2.3435, 2.5512, 2.5531, 2.3918,
2.1546, 2.3596,
2.2431, 2.1725, 2.3162, 2.3504, 2.1926,
1.9638, 2.2025),
N = 14)
inits = list( beta0 = 0, beta1 = 0, tausq = 1)
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
library(rjags)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
?dflat
model.1a = "model {
for( i in 1:N) {
xcent[i] <- x[i] - mean(x[])
}
for (i in 1:N) {
mu[i] <- beta0 + beta1 * xcent[i]
y[i] ~ dnorm( mu[i], tausq )
}
beta0 ~ dunif(-1e10, 1e10)
beta1 ~ dunif(-1e10, 1e10)
tausq ~ dgamma( 0.001, 0.001)
sigma <- 1 / sqrt(tausq)
}
"
cat(model.1a, file = {Ex18.1model = tempfile()})
data.1a = list( x = c(1997, 1998, 1999, 2000, 2001, 2002, 2003,
2004, 2005, 2006, 2007, 2008, 2009, 2010),
y = c(2.2952, 2.3435, 2.5512, 2.5531, 2.3918,
2.1546, 2.3596,
2.2431, 2.1725, 2.3162, 2.3504, 2.1926,
1.9638, 2.2025),
N = 14)
inits = list( beta0 = 0, beta1 = 0, tausq = 1)
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
library(rjags)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
inits = list( beta0 = 0, beta1 = 0, tausq = 1)
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
library(rjags)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
inits = list(list( beta0 = 0, beta1 = 0, tausq = 1), list( beta0 = 10, beta1 = 10, tausq = 10), list( beta0 = 100, beta1 = 0.1, tausq = 0.1))
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
library(rjags)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("", "sigma2.with"), n.iter=5000)
x = coda.samples(m, c("", "sigma2.with"), n.iter=5000)
x = coda.samples(m, c(""), n.iter=5000)
x = coda.samples(m, c("beta1"), n.iter=5000)
save(x, file = "18.1a.file")
load("18.1a.file")
gelman.plot(x)
model.1a = "model {
for( i in 1:N) {
xcent[i] <- x[i] - mean(x[])
}
for (i in 1:N) {
mu[i] <- beta0 + beta1 * xcent[i]
y[i] ~ dnorm( mu[i], tausq )
}
beta0 ~ dunif(-1e10, 1e10)
beta1 ~ dunif(-1e10, 1e10)
tausq ~ dgamma( 0.001, 0.001)
sigma <- 1 / sqrt(tausq)
}
"
cat(model.1a, file = {Ex18.1model = tempfile()})
data.1a = list( x = c(1997, 1998, 1999, 2000, 2001, 2002, 2003,
2004, 2005, 2006, 2007, 2008, 2009, 2010),
y = c(2.2952, 2.3435, 2.5512, 2.5531, 2.3918,
2.1546, 2.3596,
2.2431, 2.1725, 2.3162, 2.3504, 2.1926,
1.9638, 2.2025),
N = 14)
inits = list(list( beta0 = 0, beta1 = 0, tausq = 1), list( beta0 = 10, beta1 = 10, tausq = 10), list( beta0 = 100, beta1 = 0.1, tausq = 0.1))
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
library(rjags)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1"), n.iter=5000)
save(x, file = "18.1a.file")
load("18.1a.file")
gelman.plot(x)
x = coda.samples(m, c("beta0", "beta1"), n.iter=5000)
gelman.plot(x)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1"), n.iter=5000)
gelman.plot(x)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1"), n.iter=4000)
gelman.plot(x)
traceplot(x)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1"), n.iter=5000)
save(x, file = "18.1a.file")
load("18.1a.file")
traceplot(x)
gelman.plot(x)
x = coda.samples(m, c("beta0", "beta1", "sigma"), n.iter=5000)
save(x, file = "18.1a.file")
load("18.1a.file")
traceplot(x)
gelman.plot(x)
summary(x)
summary(window(x, 500, 5000)
summary(window(x, 500, 5000))
summary(window(x, 500, 5000))
traceplot(x)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1", "sigma"), n.iter=5000)
save(x, file = "18.1a.file")
load("18.1a.file")
traceplot(x)
gelman.plot(x)
summary(window(x, 1500, 6000))
summary(window(x, 500, 6000))
summary(window(x, 500, 5000))
summary(window(x, 1500, 6000))
x
x$beta1
x[2]
x[,2]
View(x)
x[,2][1:10]
x[,2]
x[[2]]
x[2,]
x[,,2]
x[,2,]
mean(x[,2,])
x[[1]][1]
x[[1]][,1]
mean(x[[1]][,1])
x[[1]][1,
x[[1]][1,]
x[[1]][1,]
x[[1]][2,]
x[[1]][,2]
x[[,]][,2]
x[,2]
mean(x[,2])
mean(x[[1]][,2])
x[[3]][,2]))
mean(c(x[[1]][,2]),
x[[2]][,2]),
x[[3]][,2])
mean(c(x[[1]][,2],
x[[2]][,2],
x[[3]][,2]))
x[[1]][,2]
x[[1]][1500,2]
x[[1]][1500:6000,2]
x[[1]][1500:5000,2]
x[[1]][500,2]
x[[1]][500:5000,2]
mean(c(x[[1]][500:5000,2],
x[[2]][500:5000,2],
x[[3]][500:5000,2]))
mean(c(x[[1]][500:5000,2],
x[[2]][500:5000,2],
x[[3]][500:5000,2]))
mean(c(mean(x[[1]][500:5000,2]),
mean(x[[2]][500:5000,2]),
mean(x[[3]][500:5000,2])))
mean(c(mean(x[[1]][500:5000,2]),
mean(x[[2]][500:5000,2]),
mean(x[[3]][500:5000,2])))
2
mean(c(mean(x[[1]][500:5000,2]),
mean(x[[2]][500:5000,2]),
mean(x[[3]][500:5000,2])))
mean(c(mean(x[[1]][500:5000,2]),
mean(x[[2]][500:5000,2]),
mean(x[[3]][500:5000,2])))
mean(c(mean(x[[1]][500:5000,2]),
mean(x[[2]][500:5000,2]),
mean(x[[3]][500:5000,2])))
beta1.values = c(mean(x[[1]][500:5000,2]),
mean(x[[2]][500:5000,2]),
mean(x[[3]][500:5000,2])))
beta1.values = c(x[[1]][500:5000,2],
x[[2]][500:5000,2],
x[[3]][500:5000,2]))
beta1.values = c(x[[1]][500:5000,2],
x[[2]][500:5000,2],
x[[3]][500:5000,2])
beta1.values
mean(beta1.values)
mean(beta1.values > 0)
0.0191/2
qt( -2.706)
qt( -2.706, 12)
pt( -2.706, 12)
pt(-2.708, 12)
mean(beta1.values > 0)
?dnorm
model.2 = "model {
for( i in 1:N) {
xcent[i] <- x[i] - mean(x[])
}
for (i in 1:N) {
mu[i] <- beta0 + beta1 * xcent[i]
y[i] ~ dnorm( mu[i], tausq )
}
beta0 ~ dnorm(2, 0.25)
beta1 ~ dunif(0, 0.25)
tausq ~ dgamma( 0.001, 0.001)
sigma <- 1 / sqrt(tausq)
}
"
cat(model.2, file = {Ex18.2model = tempfile()})
data.1a = list(
x = c(1997, 1998, 1999, 2000, 2001, 2002, 2003,
2004, 2005, 2006, 2007, 2008, 2009, 2010),
y = c(2.2952, 2.3435, 2.5512, 2.5531, 2.3918,
2.1546, 2.3596,
2.2431, 2.1725, 2.3162, 2.3504, 2.1926,
1.9638, 2.2025),
N = 14)
inits = list(list( beta0 = 0, beta1 = 0, tausq = 1), list( beta0 = 10, beta1 = 10, tausq = 10), list( beta0 = 100, beta1 = 0.1, tausq = 0.1))
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
m <- jags.model(Ex18.2model, d, inits, n.chains=3)
beta1 ~ dnorm(0, 0.25)
model.2 = "model {
for( i in 1:N) {
xcent[i] <- x[i] - mean(x[])
}
for (i in 1:N) {
mu[i] <- beta0 + beta1 * xcent[i]
y[i] ~ dnorm( mu[i], tausq )
}
beta0 ~ dnorm(2, 0.25)
beta1 ~ dnorm(0, 0.25)
tausq ~ dgamma( 0.001, 0.001)
sigma <- 1 / sqrt(tausq)
}
"
cat(model.2, file = {Ex18.2model = tempfile()})
data.1a = list(
x = c(1997, 1998, 1999, 2000, 2001, 2002, 2003,
2004, 2005, 2006, 2007, 2008, 2009, 2010),
y = c(2.2952, 2.3435, 2.5512, 2.5531, 2.3918,
2.1546, 2.3596,
2.2431, 2.1725, 2.3162, 2.3504, 2.1926,
1.9638, 2.2025),
N = 14)
inits = list(list( beta0 = 0, beta1 = 0, tausq = 1), list( beta0 = 10, beta1 = 10, tausq = 10), list( beta0 = 100, beta1 = 0.1, tausq = 0.1))
d <- list(y = data.1a$y, x = data.1a$x, N = data.1a$N)
m <- jags.model(Ex18.2model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1", "sigma"), n.iter=5000)
save(x, file = "18.2.file")
load("18.2.file")
traceplot(x)
gelman.plot(x)
m <- jags.model(Ex18.1model, d, inits, n.chains=3)
x = coda.samples(m, c("beta0", "beta1", "sigma"), n.iter=5000)
traceplot(x)
load("18.2.file")
traceplot(x)
gelman.plot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
gelman.plot(x)
summary(window(x, 500, 5000))
?rstan
??rstan
install.packages("rstan")
?rstan
??rstan
library(rstan)
?rstan
?ulam
library(rethinking)
?ulam
library(rethinking)
incar = read.csv("incar_data.csv")
df = read.csv("incar_data.csv")
getwd()
setwd("C:\Users\tyler\Documents\Courses\23S\STAT 431\Project\STAT431-Group5")
setwd("\Users\tyler\Documents\Courses\23S\STAT 431\Project\STAT431-Group5")
setwd("C:/Users/tyler/Documents/Courses/23S\STAT 431\Project\STAT431-Group5")
setwd("C:/Users/tyler/Documents/Courses/23S/STAT 431/Project/STAT431-Group5")
df = read.csv("incar_data.csv")
df
summary(df)
summary(df$Sentence.Time)
View(df)
library(rethinking)
function (x, df1, df2, ncp, log = FALSE)
{
if (missing(ncp))
.Call(C_df, x, df1, df2, log)
else .Call(C_dnf, x, df1, df2, ncp, log)
}
library(rethinking)
setwd("C:/Users/tyler/Documents/Courses/23S/STAT 431/Project/STAT431-Group5")
df = read.csv("incar_data.csv")
summary(df$Sentence.Time)
View(df)
inc <- read_xlsx("C:\\Users\\tyler\\Documents\\Courses\\23S\\STAT 431\\Project/incareration.xlsx")
require(readxl)
require(tidyverse)
inc <- read_xlsx("C:\\Users\\tyler\\Documents\\Courses\\23S\\STAT 431\\Project/incareration.xlsx")
inc <- read_xlsx("C:\\Users\\tyler\\Documents\\Courses\\23S\\STAT 431\\Project/Dec-2022-Prison-Population-Data-Set.xls")
inc <- read.table("C:\\Users\\tyler\\Documents\\Courses\\23S\\STAT 431\\Project/Dec-2022-Prison-Population-Data-Set.xls")
inc <- read_xls("C:\\Users\\tyler\\Documents\\Courses\\23S\\STAT 431\\Project/Dec-2022-Prison-Population-Data-Set.xls")
View(inc)
#Change appropriate columns to data format
inc$'Date of Birth' <- as.Date(inc$'Date of Birth', format = "%m/%d/%y")
inc$'Current Admission Date' <- as.Date(inc$'Current Admission Date', format = "%m/%d/%y")
inc$'Custody Date' <- as.Date(inc$'Custody Date', format = "%m/%d/%y")
inc$'Sentence Date' <- as.Date(inc$'Sentence Date', format = "%m/%d/%y")
#Change appropriate columns to data format
inc$'Date of Birth' <- as.Date(inc$'Date of Birth', format = "%m/%d/%y")
View(inc)
?read_xls
