summary(window(x, 500, 5000))
model.pumps = "model {
for (i in 1 : N) {
theta[i] ~ dgamma(alpha, beta)
lambda[i] <- theta[i] * t[i]
x[i] ~ dpois(lambda[i])
}
alpha ~ dexp(1)
beta ~ dgamma(0.1, 1.0)
mu <- alpha / beta
thetanew ~ dgamma(alpha, beta)
xnew ~ dpois(thetanew * tnew)
}"
library(rjags)
cat(model.pumps, file = {Ex17.2model = tempfile()})
pumps = list(t = c(94.3, 15.7, 62.9, 126, 5.24, 31.4, 1.05, 1.05, 2.1, 10.5),
x = c( 5, 1, 5, 14, 3, 19, 1, 1, 4, 22), N = 10)
d <- list(x=pumps$x, t = pumps$t, tnew = 1, N = 10)
inits <- list(list(alpha = 0.1, beta = 10), list(alpha = 10, beta = 0.1), list(alpha = 10, beta = 1))
m <- jags.model(Ex17.2model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("mu", "thetanew", "xnew"), n.iter=5000)
save(x, file = "pumps.file")
load("pumps.file")
gelman.plot(x, ylim = c(0.9, 1.05))
summary(window(x, 500, 5000))
model.pumps = "model {
for (i in 1 : N) {
theta[i] ~ dgamma(alpha, beta)
lambda[i] <- theta[i] * t[i]
x[i] ~ dpois(lambda[i])
}
alpha ~ dexp(1)
beta ~ dgamma(0.1, 1.0)
mu <- alpha / beta
thetanew ~ dgamma(alpha, beta)
xnew ~ dpois(thetanew * tnew)
}"
library(rjags)
cat(model.pumps, file = {Ex17.2model = tempfile()})
pumps = list(t = c(94.3, 15.7, 62.9, 126, 5.24, 31.4, 1.05, 1.05, 2.1, 10.5),
x = c( 5, 1, 5, 14, 3, 19, 1, 1, 4, 22), N = 10)
d <- list(x=pumps$x, t = pumps$t, tnew = 1, N = 10)
inits <- list(list(alpha = 0.1, beta = 10), list(alpha = 10, beta = 0.1), list(alpha = 10, beta = 1))
m <- jags.model(Ex17.2model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("mu", "thetanew", "xnew"), n.iter=5000)
save(x, file = "pumps.file")
load("pumps.file")
gelman.plot(x, ylim = c(0.9, 1.05))
summary(window(x, 500, 5000))
model.pumps = "model {
for (i in 1 : N) {
theta[i] ~ dgamma(alpha, beta)
lambda[i] <- theta[i] * t[i]
x[i] ~ dpois(lambda[i])
}
alpha ~ dexp(1)
beta ~ dgamma(0.1, 1.0)
mu <- alpha / beta
thetanew ~ dgamma(alpha, beta)
xnew ~ dpois(thetanew * tnew)
}"
library(rjags)
cat(model.pumps, file = {Ex17.2model = tempfile()})
pumps = list(t = c(94.3, 15.7, 62.9, 126, 5.24, 31.4, 1.05, 1.05, 2.1, 10.5),
x = c( 5, 1, 5, 14, 3, 19, 1, 1, 4, 22), N = 10)
d <- list(x=pumps$x, t = pumps$t, tnew = 1, N = 10)
inits <- list(list(alpha = 0.1, beta = 10), list(alpha = 100, beta = 0.1), list(alpha = 10, beta = 1))
m <- jags.model(Ex17.2model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("mu", "thetanew", "xnew"), n.iter=5000)
save(x, file = "pumps.file")
load("pumps.file")
gelman.plot(x, ylim = c(0.9, 1.05))
summary(window(x, 500, 5000))
model.pumps = "model {
for (i in 1 : N) {
theta[i] ~ dgamma(alpha, beta)
lambda[i] <- theta[i] * t[i]
x[i] ~ dpois(lambda[i])
}
alpha ~ dexp(1)
beta ~ dgamma(0.1, 1.0)
mu <- alpha / beta
thetanew ~ dgamma(alpha, beta)
xnew ~ dpois(thetanew * tnew)
}"
library(rjags)
cat(model.pumps, file = {Ex17.2model = tempfile()})
pumps = list(t = c(94.3, 15.7, 62.9, 126, 5.24, 31.4, 1.05, 1.05, 2.1, 10.5),
x = c( 5, 1, 5, 14, 3, 19, 1, 1, 4, 22), N = 10)
d <- list(x=pumps$x, t = pumps$t, tnew = 1, N = 10)
inits <- list(list(alpha = 0.1, beta = 10), list(alpha = 10, beta = 0.1), list(alpha = 10, beta = 1))
m <- jags.model(Ex17.2model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("mu", "thetanew", "xnew"), n.iter=5000)
save(x, file = "pumps.file")
load("pumps.file")
gelman.plot(x, ylim = c(0.9, 1.05))
summary(window(x, 500, 5000))
model.3d =  "model {
model.3d ="model {
model.3d = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
cumulative.y[i , j] <- cumulative(y[i , j], y[i , j])
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(0.001, 0.001)
tau.btw ~ dgamma(0.001, 0.001)
theta ~ dnorm(0.0, 1.0E-10)
}"
}"
cat(model.dyes, file = {Ex17.3model = tempfile()})
cat(model.dyes, file = {Ex17.3model = tempfile()})
model.dyes = "model {
model.dyes = "model {
model.dyes = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
cumulative.y[i , j] <- cumulative(y[i , j], y[i , j])
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(0.001, 0.001)
tau.btw ~ dgamma(0.001, 0.001)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes, file = {Ex17.3model = tempfile()})
pumps = list(t = c(94.3, 15.7, 62.9, 126, 5.24, 31.4, 1.05, 1.05, 2.1, 10.5),
x = c( 5, 1, 5, 14, 3, 19, 1, 1, 4, 22), N = 10)
d <- list(x=pumps$x, t = pumps$t, tnew = 1, N = 10)
inits <- list(list(alpha = 0.1, beta = 10), list(alpha = 10, beta = 0.1), list(alpha = 10, beta = 1))
m <- jags.model(Ex17.2model, d, inits, n.chains=3, n.adapt=0)
cat(model.dyes, file = {Ex17.3model = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
dyes$y
dyes$batches
dyes$samples
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
?jags.model
m <- jags.model(Ex17.2model, d, n.chains=3, n.adapt=0)
m <- jags.model(Ex17.3model, d, n.chains=3, n.adapt=0)
model.dyes = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(0.001, 0.001)
tau.btw ~ dgamma(0.001, 0.001)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes, file = {Ex17.3model = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(list(alpha = 0.1, beta = 10))
m <- jags.model(Ex17.3model, d, n.chains=3, n.adapt=0)
inits <- list(list(theta=1500, tau.with=1, tau.btw=1), list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw
= 10,000, tau.with = 0.001), list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw
= 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(list(theta=1500, tau.with=1, tau.btw=1), list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw
= 10,000, tau.with = 0.001), list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
model.dyes = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(0.001, 0.001)
tau.btw ~ dgamma(0.001, 0.001)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes, file = {Ex17.3model = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(list(theta=1500, tau.with=1, tau.btw=1), list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw
= 10,000, tau.with = 0.001), list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(list(theta=1500, tau.with=1, tau.btw=1), list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw = 10,000, tau.with = 0.001), list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(list(theta=1500, tau.with=1, tau.btw=1), list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw = 10,000, tau.with = 0.001), list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw = 10,000, tau.with = 0.001),
list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(theta = 1,525, tau.btw = 10,000, tau.with = 0.001),
list(theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1,525, 1,525, 1,525, 1,525, 1,525, 1,525), theta = 1,525, tau.btw = 10,000, tau.with = 0.001),
list(mu = c(5,525, 4,525, 3,525, 2,525, 1,525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
inits
View(inits)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1,525, tau.btw = 10,000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
gelman.plot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
model.dyes = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(0.001, 0.001)
tau.btw ~ dgamma(0.001, 0.001)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes, file = {Ex17.3model = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes.file")
load("dyes.file")
gelman.plot(x, ylim = c(0.9, 1.05))
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes.file")
load("dyes.file")
gelman.plot(x, ylim = c(0.9, 1.05))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
#x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes.file")
#x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
#save(x, file = "dyes.file")
load("dyes.file")
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
autocorr.plot(x)
traceplot(x)
traceplot(x, xlim = c(500, 5000))
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes2.file")
#x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
#save(x, file = "dyes2.file")
load("dyes2.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
traceplot(x)
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(16, 1/125)
tau.btw ~ dgamma(16, 1/125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(16, 1/125)
tau.btw ~ dgamma(16, 1/125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
?dgamma
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(16, 125)
tau.btw ~ dgamma(16, 125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(1/16, 1/125)
tau.btw ~ dgamma(1/16, 1/125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
model.dyes2 = "model {
for(i in 1 : batches) {
mu[i] ~ dnorm(theta, tau.btw)
for(j in 1 : samples) {
y[i , j] ~ dnorm(mu[i], tau.with)
}
}
sigma2.with <- 1 / tau.with
sigma2.btw <- 1 / tau.btw
tau.with ~ dgamma(1/16, 125)
tau.btw ~ dgamma(1/16, 125)
theta ~ dnorm(0.0, 1.0E-10)
}"
cat(model.dyes2, file = {Ex17.3model2 = tempfile()})
dyes = list(batches = 6, samples = 5,
y = structure(
.Data = c(1545, 1440, 1440, 1520, 1580,
1540, 1555, 1490, 1560, 1495,
1595, 1550, 1605, 1510, 1560,
1445, 1440, 1595, 1465, 1545,
1595, 1630, 1515, 1635, 1625,
1520, 1455, 1450, 1480, 1445), .Dim = c(6, 5)))
d <- list(y=dyes$y, batches = dyes$batches, samples = dyes$samples)
inits <- list(
list(theta=1500, tau.with=1, tau.btw=1),
list(mu = c(1525, 1525, 1525, 1525, 1525, 1525), theta = 1525, tau.btw = 10000, tau.with = 0.001),
list(mu = c(5525, 4525, 3525, 2525, 1525, 525), theta = 1000, tau.btw = 0.001, tau.with = 10000))
m <- jags.model(Ex17.3model2, d, inits, n.chains=3, n.adapt=0)
x = coda.samples(m, c("theta", "mu", "tau.btw", "tau.with", "sigma2.btw", "sigma2.with"), n.iter=5000)
save(x, file = "dyes3.file")
load("dyes3.file")
traceplot(x)
gelman.plot(x, ylim = c(0.9, 1.05))
summary(x)
# setup
library(rethinking)
setwd("C:/Users/tyler/Documents/Courses/23S/STAT 431/Project/STAT431-Group5")
df = read.csv("incar_data.csv")
df$Race = as.numeric(as.factor(df$Race))
bin = function(data, binsize = 10, maxbin = 70) {
n_bins = maxbin / binsize + 1
binned = rep(0, length(data))
for (i in 1:length(data)) {
value = data[i]
if (value == "LIFE") {
binned[i] = n_bins
} else {
value = as.numeric(value)
if (value > maxbin) {
binned[i] = n_bins
} else {
binned[i] = ceiling(value / binsize)
}
}
}
return(binned)
}
df$bins= as.factor(bin(df$Sentence.Time))
df = df[!is.na(df$Setence.Time..num.),]
# create model
dat = list(bin = df$bins, race = df$Race, time = round(df$Setence.Time..num.))
model = ulam(
alist(
bin ~ dordlogit(phi, cutpoints),
phi <- b0[race],
b0[race] ~ dnorm(0, 1),
cutpoints ~ dnorm(0, 1)
), data = dat, chains = 4, cores = 4
)
